<!DOCTYPE html>
<html>
<head>
  <title>County Explorer</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    img { max-width: 100%; margin: 1em 0; }
    iframe { width: 100%; height: 600px; border: none; margin: 1em 0; }
  </style>
</head>
<body>
  <div id="content">Loading...</div>

  <script>
    async function loadCounty() {
      const params = new URLSearchParams(window.location.search);
      const county = params.get('county');
      if (!county) return document.getElementById('content').innerText = "No county specified.";

      const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQyRVGJUzbjaaqh6JFCSjo22E8TWflgfwhDY2NIR6JiZdZufAg7Ny66l73hU9Lo-vHRq-O730-N-pTp/pub?gid=699579989&single=true&output=csv';
      const response = await fetch(csvUrl);
      const text = await response.text();
      const rows = text.trim().split('\n').map(row => row.split(','));

      const headers = rows[0];
      const data = rows.slice(1).map(row => {
        const obj = {};
        row.forEach((cell, i) => obj[headers[i]] = cell);
        return obj;
      });

      const entry = data.find(row => row.County.toLowerCase() === county.toLowerCase());
      if (!entry) return document.getElementById('content').innerText = "County not found in sheet.";

const imageUrl = `https://stevethenoncoder.github.io/ABCMAPS/Photos/${encodeURIComponent(entry.County)}.jpg`;

const html = `
  <h1>${entry.County}</h1>
  <div>${entry.Intro}</div>
  <img src="${imageUrl}" alt="Photo of ${entry.County}" style="max-width:100%; border-radius: 8px; box-shadow: 0 0 8px #ccc;">
  <iframe src="https://stevethenoncoder.github.io/ABCMAPS/?county=${encodeURIComponent(entry.County)}"></iframe>
  <h2>Blog Posts</h2>
  <iframe src="https://sjhretire.blogspot.com/search/label/ABC%3A%20${encodeURIComponent(entry.County)}" height="800"></iframe>
`;


      document.getElementById('content').innerHTML = html;
    }

    loadCounty();
  </script>
</body>
</html>
